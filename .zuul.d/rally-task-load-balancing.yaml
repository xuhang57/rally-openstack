- job:
    name: rally-task-load-balancing
    description: A Rally job for checking Octavia plugins and legacy LbaasV2
    parent: rally-task-at-devstack
    required-projects:
      - name: openstack/devstack
      - name: openstack/devstack-gate
      - name: openstack/rally
      - name: openstack/rally-openstack
      - name: openstack/neutron-lbaas
      - name: openstack/neutron
      - name: openstack/nova
      - name: openstack/glance
      - name: openstack/octavia
      - name: openstack/python-octaviaclient
    vars:
      devstack_plugins:
        rally-openstack: https://opendev.org/openstack/rally-openstack
        neutron-lbaas: https://opendev.org/openstack/neutron-lbaas
        octavia: https://opendev.org/openstack/octavia
        barbican: https://opendev.org/openstack/barbican
        neutron: https://opendev.org/openstack/neutron
      devstack_services:
        neutron-lbaas: true
        key: true
        rabbit: true
        mysql: true
        n-api: true
        n-obj: true
        n-cpu: true
        n-cond: true
        n-sch: true
        placement-api: true
        placement-client: true
        g-api: true
        g-reg: true
        neutron-api: true
        neutron-agent: true
        neutron-dhcp: true
        neutron-l3: true
        neutron-metadata-agent: true
        neutron-qos: true
        octavia: true
        o-api: true
        o-cw: true
        o-hm: true
        o-hk: true
        o-da: true
        # disable redundant services for the job
        ceilometer-acentral: false
        ceilometer-acompute: false
        ceilometer-alarm-evaluator: false
        ceilometer-alarm-notifier: false
        ceilometer-anotification: false
        ceilometer-api: false
        ceilometer-collector: false
        horizon: false
        tempest: false
      rally_task: rally-jobs/load-balancing.yaml
